export { default as themes } from "./theme.js";

import { Head, Appear, Notes, Image } from "mdx-deck";
import { Twemoji as Emoji } from "react-emoji-render";
import QRCode from "qrcode.react";

import Mono from "./Mono.js";

<Head>
  <title>React for Command-Line Interfaces! (feat. Ink)</title>
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@hexrcs" />
  <meta name="twitter:title" content="React for Command-Line Interfaces! (feat. Ink)" />
  <meta
    name="twitter:description"
    content="Text-based CLI tools are great. They are fast, lightweight, and universally accessible. But what does CLI have to do with React? In this lightning talk, we will have a look at Ink - a wonderful custom React renderer that allows us to use Flexbox to create excellent command-line interfaces with ease. Want to create a companion CLI tool for the next big thing that you are working on? Build it with React!"
  />
  <meta
    name="twitter:image"
    content="https://reactdayberlin-node-cli-talk.netlify.com/cover.png"
  />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@1.207/distr/fira_code.css"
  />
</Head>

# React for Command-Line Interfaces!

<h2><i>feat. Ink <Emoji svg text="ðŸŒˆ" /></i></h2>
<h2></h2>

<Mono>@hexrcs</Mono>

---

import Small from "./Small.js";

<Emoji svg text="Hi there! :wave:" />

## My name is Xiaoru Li <Emoji svg text="ðŸ‡¨ðŸ‡³" />

You can also call me _Leo_

##### *Studying CS in Karlsruhe, Germany*

<Small>I post crash course threads on Twitter as @hexrcs</Small>
<br/>
<Small>And video tutorials on methodcoder.com <Emoji svg text="ðŸ˜„" /></Small>

<Notes>

Hello everyone, my name is Xiaoru Li. You can also call me Leo. 

I come from China, currently studying CS in Karlsruhe. I post crash courses like Learn GraphQL in 10 tweets on Twitter as twitter threads and I also have a YouTube channel called the Method Coder where I make short coding tutorials.

</Notes>

---

# Command-Line Interfaces

<Notes>So, today we are going to talk about building Command Line Interface apps.</Notes>

---

# CLIs and terminals have been with us since the 60s

# It's almost 2020, so why? <Emoji svg text="ðŸ¤”" />

<Notes>But these kind of applications have already been there since the 60s, I mean it's almost 2020 now, so why do we still bother building them?</Notes>

---
  <h1>
    Old, but not obsolete <Emoji svg text="ðŸ’¡" />
  </h1>
<Appear>
  <div>
     <h3><i>Think git, CRA, test runners...</i></h3>
     <h2>Practical, fast, developer-friendly!</h2>
  </div>
  <h2>Your next big project might need a CLI companion!</h2>
</Appear>

<Notes>
Well, as it turns out, these apps are still extremely relevant today.

And especially if you are a developer, we rely on CLI apps like git, create-react-app daily, because they are fast and practical.

And if you are building a library or framework, a CLI companion app, maybe one that helps bootstrapping new projects, would be super valuable to the end users as part of the toolchain.
</Notes>

---

# How do we start

## building a CLI app with Node?

<Notes>So how do we start building them with JavaScript and node?</Notes>

---

We start simple...

```js
console.log("Hello World!");
```

then run  <i> `node index.js`</i>

# <Emoji svg text=":D" />

<Notes>Well, surprisingly easy - we just save console.log "hello world" to a JS file and run it with Node.</Notes>

---

## But how can we make things more interesting?

### Bold, italics, colors, updates...

<Notes>But if we want to make things a little bit more interesting, like make the font bold, render colors, or update what's already printed to the screen...</Notes>

---

# ANSI escape code

<Mono big>ANSI === "American National Standards Institute"</Mono>

<Appear>
  <h3>
    Boy they are ugly <Emoji svg text="ðŸ˜…" />
  </h3>
</Appear>

<Notes>
We will need ANSI escape sequences to do this.

And they are super ugly if we just use them directly.

</Notes>

---

## If we want to print colored text... <Emoji svg text="ðŸ¤”" />

<Notes>So if we want to print colored text for example,</Notes>

---

import ReactDayBerlin from "./ReactDayBerlin.js";

```js
console.log(
  "\u001b[44m" + // Blue background
  "\u001b[37m" + // White text
  "\u001b[1m" + // Bold font
  "ReactDay" + // Payload 1
  "\u001b[47m" + // White background
  "\u001b[31m" + // Red text
  "Berlin" + // Payload 2
    "\u001b[0m" // Reset styling
);
```

<div
  style={{
    display: "flex",
    flexDirection: "row",
    alignItems: "center",
    justifyContent: "center",
  }}
>
  <h2 style={{ margin: "5rem" }}>
    <Emoji svg text="ðŸ‘‰" />
  </h2>
  <ReactDayBerlin />
</div>

<Notes>
We'll then need to write a whole bunch of nonsense non-printable stuff to do the formatting. And we'll have to always remember to reset styling at the end.
</Notes>

---

## If we want to update printed text... <Emoji svg text="ðŸ¤”" />

<Notes>
And if we want to update printed text,

</Notes>

---

### A simple clock

```js
function simpleClock() {
  setInterval(() => {
    const time = moment().format("h:mm:ss a");
    process.stdout.write("\u001b[1000D\u001b[K");
    process.stdout.write(time);
  }, 1000);
}
```

Move 1000 columns to the left, remove everything till end of the line

<Notes>
For example to print this simple clock that update the current time, we will need to do stuff like this.
</Notes>

---

### Layouts in a pure text environment are even tougher <Emoji svg text="ðŸ˜•" />

### And we want to update multiple chunks simultaneously... <Emoji svg text="ðŸ˜‚" />

<Notes>
And not to mention that today we can resize our terminal windows, so we can't hardcode the height and width anymore.

And things get even trickier when we want to update chunks of the UI simultaneously...
</Notes>

---

### Jest's running and watch mode

<div
  dangerouslySetInnerHTML={{
    __html: `
      <video
        style="max-width: 60%"
        loop
        autoplay
        muted
        src="./images/jest.mp4"
      />
    `,
  }}
/>

Real time status <Emoji svg text="ðŸ§­" /> Keyboard interaction <Emoji svg text="ðŸ‘¨â€ðŸ’»" />

<Notes>Like Jest's CLI for example.</Notes>

---

## Behold, we have `Ink`! <Emoji svg text="ðŸŒˆ" />

![Ink logo](./images/ink-logo.png)

*from @vadimdemedes and @sindresorhus*

<Appear>
  <div style={{ marginTop: "4em" }}>
    <h3>
      <Emoji svg text="âœ…" /> Custom React renderer
    </h3>
    <h3>
      <Emoji svg text="âœ…" /> Flexbox magic in the terminal <Emoji svg text="ðŸ¤¯" />
    </h3>
  </div>
</Appear>

<Notes>
That's when Ink comes into the rescue.

It's a custom React renderer that renders components to text, with all the ANSI stuff together.

And it lets us use Flexbox for the layout. How cool is that?
</Notes>

---

```jsx
import React, { useEffect, useState } from "react";
import { Text, Box, Color, useInput, render } from "ink";
import Gradient from "ink-gradient";
import BigText from "ink-big-text";
import Spinner from "ink-spinner";
import TextInput from "ink-text-input";
import Ascii from "ink-ascii";
```

Import built-in & 3rd party Ink components <Emoji svg text="â˜ï¸" />

<Notes>
So building Ink apps is like building any other React apps. We import the stuff we need, and we write custom components.
</Notes>

---

## An example?

<img src="./images/wiki-client.png" />

<Notes>For example, if we want to build something like this wiki app,</Notes>

---

```jsx
const AppContext = createContext();
const Wiki = () => {
  // init keypress handling, useStates and so on...
  return (
    <AppContext.Provider value={{ ...statesAndSetters }}>
      <Box flexDirection="column" marginY={1}>
        <InstantSearchBar />
        <ResultsListing />
        <StatusInfoBar />
      </Box>
    </AppContext.Provider>
  );
};

render(<Wiki />);
```

Just like building any React app <Emoji svg text="â˜ï¸" />

<Notes>We can write JSX for the UI, as simple as that.</Notes>

---

<div
  dangerouslySetInnerHTML={{
    __html: `
      <video
        style="height: 90vh;"
        loop
        autoplay
        muted
        src="./images/demo-wiki.mp4"
      />
    `,
  }}
/>

<Notes>And here's how it looks like</Notes>

---

### More awesomeness with Ink

<Image src="./images/ink-mdx.png" style={{height: "70vh", width: "70vw"}} size="contain" />

MDX rendered directly to the terminal!

<Notes>And with Ink, we can actually also render MDX to the terminal. This would be very useful for building help manuals for the app.</Notes>

---

### Even more awesomeness with Ink

<Image src="./images/pastel-logo.png" style={{height: "50vh", width: "50vw"}} size="contain" />

<Notes>
And with a framework based on Ink called Pastel
</Notes>

---

```text
git-js/
  - package.json
  - commands/
    - index.js
    - add.js
    - checkout.js
    - commit.js
    - stash/
      - index.js
      - clear.js
      - pop.js
        ...
```

`git stash pop` anyone?

<Notes>
We can even build a CLI app like a Next.js app, the difference here is that instead of different routes, we have different subcommands.

Super cool!

</Notes>

---

## Check out `react-blessed` too!

### Renders to `blessed` widgets

### More suitable for fullscreen apps

<Notes>There's another library that let's us write React for CLI apps, called react-blessed, and it's more suitable for fullscreen apps like a text editor.</Notes>

---

<Image src="./images/thats-all-folks.png" size="contain" />

<Notes>And that's all I have for you today, hope you have found it useful!</Notes>

---

# Thank you! <Emoji svg text="ðŸ™Œ" />

Source code of slides and demos can be found here <Emoji svg text="ðŸ‘‡" />

<div
  style={{
    display: "flex",
    justifyContent: "center",
  }}
>
  <div
    style={{
      padding: "1rem",
      backgroundColor: "white",
    }}
  >
    <QRCode
      value="https://github.com/hexrcs/201912-rdberlin-node-cli-talk"
      size={500}
    />
  </div>
</div>

`https://github.com/hexrcs/201912-rdberlin-node-cli-talk`


---

### Links and Acknowledgements

NPM modules

- [Ink](https://github.com/vadimdemedes/ink)
- [Pastel](https://github.com/vadimdemedes/pastel)
- [React Blessed](https://github.com/Yomguithereal/react-blessed)

Articles

- [Awesome List - Node CLI utils](https://github.com/sindresorhus/awesome-nodejs#command-line-utilities)
- [More about ANSI escape code](https://en.wikipedia.org/wiki/ANSI_escape_code)
- [A great article on building vanilla CLI tools with Python](http://www.lihaoyi.com/post/BuildyourownCommandLinewithANSIescapecodes.html)
- [Render MDX to the Terminal with Ink](https://mdxjs.com/guides/terminal)

Images

- [That's all folks](https://twitter.com/ontariocofc/status/803779593631105024)
